---
import Layout from '@layouts/Layout.astro';
import {
    getAllProperties,
    setArticleId,
    setClangId,
} from '@helpers/properties-management/server-properties';
import { getArticleById, getArticleByPath } from '@adapters/redaxo/article';
import { getContentTypeByPath } from '@adapters/kreatif-redaxo-adapter/content-type';

const { path } = Astro.params;

if (path === 'sitemap.xml' || path === 'robots.txt') {
    return Astro.redirect(`${import.meta.env.REDAXO_ROOT}/${path}`, 301);
}

const contentType = await getContentTypeByPath(path ?? '/', '1');
setClangId(Astro, contentType.clang.id);

const article = await getArticleById(
    contentType.elementId,
    contentType.clang.id,
    {
        breadcrumbs: true,
        seo: true,
        slices: true,
        clang: true,
    },
);

setArticleId(Astro, article.id);
---

<Layout article={article} />
