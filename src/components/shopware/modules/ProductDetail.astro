---
import {
    ShopwareApiInstance,
    createInstance,
    getProduct,
} from '@shopware-pwa/shopware-6-client';
import ProductDetail from '../utils/ProductDetail';

const contextToken = Astro.cookies.get('sw-context-token').value;
const swLangId = Astro.cookies.get('sw-language-id').value;
const productId = Astro.cookies.get('productId').value;
const contextInstance: ShopwareApiInstance = createInstance({
    endpoint: import.meta.env.SHOPWARE_ENDPOINT,
    accessToken: import.meta.env.SHOPWARE_ACCESS_KEY,
    languageId: swLangId,
    contextToken: contextToken,
});
const _response = await getProduct(
    productId,
    { associations: { media: [] } },
    contextInstance,
);
---

<ProductDetail
    client:only="preact"
    product={_response.product}
    configurator={_response.configurator}
/>
