---
import {
    ShopwareApiInstance,
    createInstance,
    getProduct,
} from '@shopware-pwa/shopware-6-client';
import ProductDetail from '../utils/ProductDetail';
const { itemId } = Astro.props;

const contextToken = Astro.cookies.get('sw-context-token').value;
const swLangId = Astro.cookies.get('sw-language-id').value;
const productId = itemId;
const contextInstance: ShopwareApiInstance = createInstance({
    endpoint: import.meta.env.PUBLIC_SHOPWARE_ENDPOINT,
    accessToken: import.meta.env.PUBLIC_SHOPWARE_ACCESS_KEY,
    languageId: swLangId,
    contextToken: contextToken,
});

if (productId === undefined) {
    return;
}

const _response = await getProduct(
    productId,
    { associations: { media: [] } },
    contextInstance,
);
---

<ProductDetail
    client:only="preact"
    product={_response.product}
    configurator={_response.configurator}
/>
